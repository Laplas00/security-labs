
{% extends "base.html" %}
{% block content %}
<!--ng-app-->
<div >
  <!-- Jinja –±–ª–æ–∫ ‚Äî –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —á—Ç–æ –ø—Ä–∏—à–ª–æ —Å backend, Angular —Ç—É—Ç –Ω–µ –≤–ª–∏—è–µ—Ç -->

{% if vulnerability == 'xss_angular_sandbox_escape' %}
  <div>
    <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–∏—Å–∫–∞ (Jinja):</h3>
    <div style="color:gray;">{{ q }}</div>
  </div>
  <div>
    <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–∏—Å–∫–∞ (—Å–∏–º—É–ª—è—Ü–∏—è Angular XSS):</h3>
  
    {% if "constructor.prototype" in q or "fromCharCode" in q or "filter.constructor" in q %}
      <script>alert("–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –§–ª–∞–≥: LAB_FLAG{sandbox_escape_worked}")</script>
      <div style="color:green;">–§–ª–∞–≥: <b>LAB_FLAG{sandbox_escape_worked}</b></div>
    {% else %}
      <div>–ü—Ä–∏–º–µ—Ä —Å–ª–æ–∂–Ω–æ–≥–æ payload: <br>
        <code>{}.toString.constructor.prototype.charAt=[].join;$event.view.alert(1)</code><br>
        –ü–æ–ø—Ä–æ–±—É–π —Ä–∞–∑–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å <b>constructor.prototype</b> –∏ <b>fromCharCode</b>.
      </div>
    {% endif %}
  </div>

{% endif %}
<!---->

  <div class="feed-container" style="margin-top:32px;">
    {% for post in posts %}
      <div class="post-card">
        <div class="post-card__info">
          <div class="post-card__meta">
            <span class="post-card__author">{{ post.author }}</span>
            <span class="post-card__date">{{ post.date or '' }}</span>
            <span class="post-card__comments">üí¨ {{ post.comment_count }} comments</span>
          </div>
          <a href="{{ url_for('post', post_id=post['id']) }}" class="post-card__title">
            {{ post.title }}
          </a>
          <div class="post-card__subtitle">{{ post.subtitle or post.content[:128] ~ "..." }}</div>
        </div>
      </div>
    {% endfor %}
  </div>
</div>
{% endblock %}

