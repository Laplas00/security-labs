
{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">

  <h2>Stored XSS (Cross-Site Scripting)</h2>
  <br>

  <p><strong>Stored XSS</strong> is a type of web vulnerability where malicious JavaScript code is <strong>stored on the server</strong> and later displayed to users, leading to script execution in their browsers.</p>

  <p>Unlike reflected XSS, stored XSS doesn't require the victim to click a crafted link — the payload lives in the system and runs automatically when a page is loaded.</p>

  <h5>📌 Example scenario:</h5>
  <p>Imagine a comment form that stores user input in a database and displays it like this:</p>
  <pre><code>
  &lt;div class="comment"&gt;
    &lt;strong&gt;User:&lt;/strong&gt; attacker &lt;br&gt;
    &lt;script&gt;alert('XSS')&lt;/script&gt;
  &lt;/div&gt;
  </code></pre>

  <p>If the application does not sanitize the input, anyone viewing this page will trigger the attacker's script.</p>

  <h5>🎯 Attack goals:</h5>
  <ul>
    <li>Automatic script execution for all viewers</li>
    <li>Session or cookie theft</li>
    <li>Injecting fake UI or phishing forms</li>
    <li>Propagating self-replicating XSS worms</li>
  </ul>

  <h5>⚠️ Vulnerable areas:</h5>
  <ul>
    <li>Comment sections</li>
    <li>Forum posts or chat systems</li>
 
{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">

  <h2>Stored XSS (Cross-Site Scripting)</h2>
  <br>

  <p><strong>Stored XSS</strong> is a type of web vulnerability where malicious JavaScript code is <strong>stored on the server</strong> and later displayed to users, leading to script execution in their browsers.</p>

  <p>Unlike reflected XSS, stored XSS doesn't require the victim to click a crafted link — the payload lives in the system and runs automatically when a page is loaded.</p>

  <h5>📌 Example scenario:</h5>
  <p>Imagine a comment form that stores user input in a database and displays it like this:</p>
  <pre><code>
  &lt;div class="comment"&gt;
    &lt;strong&gt;User:&lt;/strong&gt; attacker &lt;br&gt;
    &lt;script&gt;alert('XSS')&lt;/script&gt;
  &lt;/div&gt;
  </code></pre>

  <p>If the application does not sanitize the input, anyone viewing this page will trigger the attacker's script.</p>

  <h5>🎯 Attack goals:</h5>
  <ul>
    <li>Automatic script execution for all viewers</li>
    <li>Session or cookie theft</li>
    <li>Injecting fake UI or phishing forms</li>
    <li>Propagating self-replicating XSS worms</li>
  </ul>

  <h5>⚠️ Vulnerable areas:</h5>
  <ul>
    <li>Comment sections</li>
    <li>Forum posts or chat systems</li>
    <li>User profile data (e.g., bio, status)</li>
    <li>Any stored input that gets rendered later</li>
  </ul>

  <h5>🧪 Testing tips:</h5>
  <ul>
    <li>Submit: <code>&lt;script&gt;alert('Stored XSS')&lt;/script&gt;</code> as a comment or post</li>
    <li>Refresh the page — if the alert appears, the payload was stored</li>
    <li>Check HTML output — is it rendered as script or escaped?</li>
  </ul>

  <p><strong>Key concept:</strong> Stored XSS stays in the system — it infects future views of the content without additional interaction.</p>

  <p>Status: {{ vuln_mode }}</p>
  <p>App status: {{ status }}</p>

  {% if status.status == "running" %}
  <p><a href="{{ status.url }}">Try the stored XSS lab</a></p>

  <form action="{% url 'stop_lab' %}" method="POST" style="display: inline">
    {% csrf_token %}
      <button type="submit">🛑 Stop Lab</button>
      <input type="hidden" name="lab" value="{{ lab_name }}">
  </form>

  <form action="{% url 'toggle_vuln' %}" method="POST" style="display: inline">
    {% csrf_token %}
      <input type="hidden" name="lab" value="{{ lab_name }}">
      <button type="submit">⚙️ Toggle Vulnerability</button>
  </form>

  {% else %}
  <form action="{% url 'start_lab' %}" method="POST" style="display: inline">
    {% csrf_token %}
    <input type="hidden" name="lab" value="{{ lab_name }}">
      <button type="submit">🚀 Start Lab</button>
  </form>
  {% endif %}

</div>
{% endblock %}   <li>User profile data (e.g., bio, status)</li>
    <li>Any stored input that gets rendered later</li>
  </ul>

  <h5>🧪 Testing tips:</h5>
  <ul>
    <li>Submit: <code>&lt;script&gt;alert('Stored XSS')&lt;/script&gt;</code> as a comment or post</li>
    <li>Refresh the page — if the alert appears, the payload was stored</li>
    <li>Check HTML output — is it rendered as script or escaped?</li>
  </ul>

  <p><strong>Key concept:</strong> Stored XSS stays in the system — it infects future views of the content without additional interaction.</p>

  <p>Status: {{ vuln_mode }}</p>
  <p>App status: {{ status }}</p>

  {% if status.status == "running" %}
  <p><a href="{{ status.url }}">Try the stored XSS lab</a></p>

  <form action="{% url 'stop_lab' %}" method="POST" style="display: inline">
    {% csrf_token %}
      <button type="submit">🛑 Stop Lab</button>
      <input type="hidden" name="lab" value="{{ lab_name }}">
  </form>

  <form action="{% url 'toggle_vuln' %}" method="POST" style="display: inline">
    {% csrf_token %}
      <input type="hidden" name="lab" value="{{ lab_name }}">
      <button type="submit">⚙️ Toggle Vulnerability</button>
  </form>

  {% else %}
  <form action="{% url 'start_lab' %}" method="POST" style="display: inline">
    {% csrf_token %}
    <input type="hidden" name="lab" value="{{ lab_name }}">
      <button type="submit">🚀 Start Lab</button>
  </form>
  {% endif %}

</div>
{% endblock %}

